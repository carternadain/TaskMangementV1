generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id            String       @id @default(cuid())
  email         String       @unique
  password      String
  role          Role         @default(USER)
  orgId         String
  createdAt     DateTime     @default(now())
  organization  Organization @relation(fields: [orgId], references: [id]) // Explicit relation to Organization
  createdTasks  Task[]       @relation("CreatedTasks") // Tasks created by this user
  assignedTasks Task[]       @relation("AssignedTasks") // Tasks assigned to this user

  @@map("users")
}

model Organization {
  id    String @id @default(cuid())
  name  String
  users User[] // One-to-many relation with User
  tasks Task[]

  @@map("organizations")
}

model Task {
  id           String       @id @default(cuid())
  title        String
  description  String?
  status       TaskStatus   @default(TODO)
  assigneeId   String?
  orgId        String
  createdById  String
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  organization Organization @relation(fields: [orgId], references: [id])
  assignee     User?        @relation("AssignedTasks", fields: [assigneeId], references: [id])
  createdBy    User         @relation("CreatedTasks", fields: [createdById], references: [id])

  @@map("tasks")
}

enum Role {
  ADMIN
  MANAGER
  USER
}

enum TaskStatus {
  TODO
  IN_PROGRESS
  DONE
}
